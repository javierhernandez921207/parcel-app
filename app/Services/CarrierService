<?php
namespace App\Services;
use Illuminate\Support\Facades\Http;

class CarrierService {

    private $url;
    private $sender_address;

    public function __construct() {
        $this->url = 'https://fedex.test/api/delivery';        
        $this->sender_address = env('SENDER_ADDRESS');        
    }

    public function SendDelivery($customer_name, $phone_number, $email, $recipient_address, $parcels) {        
        $data = [
            'customer_name' => $customer_name,
            'phone_number' => $phone_number,
            'email' => $email,
            'sender_address' => $this->sender_address,
            'recipient_address' => $recipient_address,
            'parcels' => $parcels
        ];
        
        $response = Http::post($this->url, $data);
        
        if ($response->successful()) {
            $tracking_number = $response->json()['tracking_number'];        
            return $tracking_number;
        } else {   
            return 0;
        }
    }
}

